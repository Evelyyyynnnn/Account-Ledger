# ğŸ”§ è§£å†³ GitHub Secret Scanning æŠ¥é”™

## âš ï¸ é—®é¢˜

GitHub æ£€æµ‹åˆ°ä½ çš„ Git æäº¤å†å²ä¸­åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆAPI Keyï¼‰ï¼š
- `backend/.env` æ–‡ä»¶åœ¨ commit `ff9f4be` ä¸­åŒ…å« API Key
- å³ä½¿å·²ç»ä»å½“å‰ä»£ç ä¸­ç§»é™¤äº†ï¼Œ**Git å†å²è®°å½•**ä¸­ä»ç„¶å­˜åœ¨

---

## âœ… è§£å†³æ–¹æ¡ˆï¼ˆé€‰æ‹©å…¶ä¸­ä¸€ä¸ªï¼‰

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨æ¸…ç†è„šæœ¬ï¼ˆæ¨èï¼‰

æˆ‘å·²ç»ä¸ºä½ åˆ›å»ºäº†ä¸€ä¸ªæ¸…ç†è„šæœ¬ï¼Œè¿è¡Œå®ƒå³å¯ï¼š

```bash
bash æ¸…ç†æ•æ„Ÿä¿¡æ¯.sh
```

ç„¶åå¼ºåˆ¶æ¨é€ï¼š

```bash
git push origin main --force
```

âš ï¸ **æ³¨æ„**ï¼šå¦‚æœä½ å·²ç»æ¨é€è¿‡ä»£ç åˆ° GitHubï¼Œå¼ºåˆ¶æ¨é€ä¼šè¦†ç›–è¿œç¨‹å†å²ã€‚å¦‚æœä»“åº“æœ‰åä½œè€…ï¼Œéœ€è¦æå‰é€šçŸ¥ä»–ä»¬ã€‚

---

### æ–¹æ¡ˆäºŒï¼šæ‰‹åŠ¨ä½¿ç”¨ git filter-branch

å¦‚æœä½ æƒ³æ‰‹åŠ¨æ‰§è¡Œï¼š

```bash
# 1. ä»æ‰€æœ‰å†å²ä¸­ç§»é™¤ backend/.env
git filter-branch --force --index-filter \
  "git rm --cached --ignore-unmatch backend/.env" \
  --prune-empty --tag-name-filter cat -- --all

# 2. æ¸…ç†å¼•ç”¨
git for-each-ref --format="%(refname)" refs/original/ | xargs -n 1 git update-ref -d

# 3. æ¸…ç†å’Œå‹ç¼©
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# 4. å¼ºåˆ¶æ¨é€ï¼ˆâš ï¸ åªåœ¨ç¡®è®¤åæ‰§è¡Œï¼‰
git push origin main --force
```

---

### æ–¹æ¡ˆä¸‰ï¼šé‡æ–°åˆ›å»ºå¹²å‡€çš„æäº¤å†å²ï¼ˆæœ€ç®€å•ï¼‰

å¦‚æœé¡¹ç›®åˆšå¼€å§‹ï¼Œè¿™æ˜¯æœ€ç®€å•çš„æ–¹æ³•ï¼š

```bash
# 1. å¤‡ä»½å½“å‰ä»£ç 
cd ..
cp -r github-Account-Ledger github-Account-Ledger-backup
cd github-Account-Ledger

# 2. åˆ é™¤ .git æ–‡ä»¶å¤¹ï¼ˆæ¸…é™¤æ‰€æœ‰å†å²ï¼‰
rm -rf .git

# 3. é‡æ–°åˆå§‹åŒ– Git
git init

# 4. ç¡®ä¿ .gitignore æ­£ç¡®ï¼ˆå·²é…ç½®ï¼‰
# æ£€æŸ¥ .gitignore åŒ…å«ï¼š
#   .env
#   backend/.env
#   frontend/.env

# 5. æ·»åŠ æ‰€æœ‰æ–‡ä»¶ï¼ˆ.env ä¼šè¢«è‡ªåŠ¨å¿½ç•¥ï¼‰
git add .

# 6. æäº¤å¹²å‡€çš„ä»£ç 
git commit -m "Initial commit - clean version (no sensitive info)"

# 7. æ·»åŠ è¿œç¨‹ä»“åº“
git remote add origin https://github.com/Evelyyyynnnn/Account-Ledger.git

# 8. å¼ºåˆ¶æ¨é€ï¼ˆè¦†ç›–è¿œç¨‹å†å²ï¼‰
git push -u origin main --force
```

---

### æ–¹æ¡ˆå››ï¼šä½¿ç”¨ BFG Repo-Cleanerï¼ˆæœ€å®‰å…¨ï¼Œä½†éœ€è¦ Javaï¼‰

å¦‚æœä½ æœ‰ Java ç¯å¢ƒï¼š

```bash
# 1. å®‰è£… BFG
# macOS: brew install bfg

# 2. å…‹éš†ä¸ºé•œåƒä»“åº“
cd /tmp
git clone --mirror https://github.com/Evelyyyynnnn/Account-Ledger.git

# 3. åˆ é™¤ .env æ–‡ä»¶
bfg --delete-files backend/.env Account-Ledger.git

# 4. æ¸…ç†
cd Account-Ledger.git
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# 5. æ¨é€
git push --force
```

---

## ğŸ¯ æˆ‘çš„æ¨è

**å¦‚æœä½ è¿˜æ²¡æœ‰æ¨é€è¿‡ä»£ç ï¼Œæˆ–è€…å¯ä»¥é‡æ–°å¼€å§‹ï¼š**
â†’ ä½¿ç”¨ **æ–¹æ¡ˆä¸‰**ï¼ˆé‡æ–°åˆ›å»ºå†å²ï¼‰- æœ€ç®€å•å®‰å…¨

**å¦‚æœä½ å·²ç»æ¨é€è¿‡ä»£ç ï¼Œä½†ä¸ä»‹æ„è¦†ç›–å†å²ï¼š**
â†’ ä½¿ç”¨ **æ–¹æ¡ˆä¸€**ï¼ˆæ¸…ç†è„šæœ¬ï¼‰- è‡ªåŠ¨åŒ–å¤„ç†

**å¦‚æœä½ éœ€è¦ä¿æŒå†å²è®°å½•ï¼š**
â†’ ä½¿ç”¨ **æ–¹æ¡ˆäºŒ**ï¼ˆgit filter-branchï¼‰- æ‰‹åŠ¨æ§åˆ¶

---

## âœ… éªŒè¯æ¸…ç†ç»“æœ

æ¸…ç†åéªŒè¯ï¼š

```bash
# æ£€æŸ¥ .env æ–‡ä»¶æ˜¯å¦è¿˜åœ¨å†å²ä¸­
git log --all --full-history --source -- "backend/.env"

# åº”è¯¥è¿”å›ç©ºï¼ˆæ²¡æœ‰è¾“å‡ºï¼‰

# æ£€æŸ¥å½“å‰å·¥ä½œç›®å½•
git ls-files | grep "\.env$"

# åº”è¯¥åªçœ‹åˆ° .env.exampleï¼ˆå¦‚æœæœ‰ï¼‰
```

---

## ğŸš€ æ¸…ç†åæ¨é€

æ¸…ç†å®Œæˆåï¼š

```bash
# 1. ç¡®è®¤çŠ¶æ€
git status

# 2. å¦‚æœéœ€è¦ï¼Œæäº¤å…¶ä»–æ›´æ”¹
git add .
git commit -m "chore: æ¸…ç†æ•æ„Ÿä¿¡æ¯ï¼Œæ›´æ–°æ–‡æ¡£"

# 3. æ¨é€ï¼ˆå¦‚æœä½¿ç”¨æ–¹æ¡ˆä¸€æˆ–äºŒï¼Œéœ€è¦ --forceï¼‰
git push origin main --force
```

---

## ğŸ”’ é¢„é˜²æªæ–½

ä»¥åé¿å…ç±»ä¼¼é—®é¢˜ï¼š

1. âœ… **ç¡®ä¿ .gitignore åŒ…å« `.env`**ï¼ˆå·²é…ç½®ï¼‰
2. âœ… **ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥**
3. âœ… **ä½¿ç”¨ç¯å¢ƒå˜é‡**ï¼ˆæœ¬åœ°ç”¨ `.env`ï¼ŒVercel ç”¨ Dashboardï¼‰
4. âœ… **æ¨é€å‰æ£€æŸ¥**ï¼š
   ```bash
   git diff HEAD | grep -i "api.*key\|secret\|password"
   ```
5. âœ… **ä½¿ç”¨ `.env.example`** ä½œä¸ºæ¨¡æ¿ï¼ˆä¸åŒ…å«çœŸå®å¯†é’¥ï¼‰

---

## ğŸ“ å½“å‰çŠ¶æ€

æˆ‘å·²ç»å¸®ä½ ï¼š
- âœ… ä» Git ç´¢å¼•ä¸­ç§»é™¤äº† `backend/.env`
- âœ… ä¿®å¤äº† `README.md` ä¸­çš„ API Key
- âœ… åˆ›å»ºäº†æ¸…ç†è„šæœ¬

**ç°åœ¨ä½ éœ€è¦ï¼š**
1. é€‰æ‹©ä¸Šé¢çš„ä¸€ä¸ªæ–¹æ¡ˆæ‰§è¡Œ
2. æ¸…ç†å®Œæˆåæ¨é€ä»£ç 

---

## â“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·å‘Šè¯‰æˆ‘ä½ é€‰æ‹©äº†å“ªä¸ªæ–¹æ¡ˆï¼Œé‡åˆ°äº†ä»€ä¹ˆé”™è¯¯ä¿¡æ¯ã€‚

